---
layout: post
title:  "Mysql的逻辑架构"
date:   2019-12-11 13:33
categories: Mysql
tags: 逻辑架构
excerpt: 知识点记录
author: Pythonbug
mathjax: true
---

## Mysql逻辑架构图
![](https://static001.geekbang.org/resource/image/0d/d9/0d2070e8f84c4801adbfa03bda1f98d9.png)

### 1 连接器
验证用户权限，用户密码认证通过，连接器就会去权限表查出拥有的权限。之后，这个连接里面的权限判断逻辑，都将依赖于此时读到的权限。

### 2 分析器
词法分析，语法分析，如果说某一个表中某个字段不存在，那么报错就在这一步。

### 3 优化器
执行计划生成，索引选择

### 4 执行器
操作引擎，返回结果。权限验证也会在这一步，有人问，为啥不在优化器之前作验证呢。如果没有权限，去优化sql，不是白做优化吗？还浪费资源。
这是因为，有的sql不只是表面上看起来那么简单。
比如，某一个sql关联了触发器，这个得执行的时候才会知道。所以权限验证在执行器做。
>有个precheck是在查询的时候做。

这句话我其实并不大理解的。目前想的是precheck应该是一种提前检查权限，和这里执行器中权限检查是两回事。